<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>빨간약 EP 앨범 'ROOM 405' 구매 신청서</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600&display=swap');
    :root { --primary-color: #4A90E2; --secondary-color: #50E3C2; --bg-color: #F7FAFC; --card-bg: #FFFFFF; --text-color: #333333; --border-radius: 12px; --transition: 0.3s; --shadow: 0 6px 18px rgba(0,0,0,0.1); }
    *, *::before, *::after { box-sizing: border-box; }
    body { font-family: 'Quicksand', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 20px 0; }
    .container { width: 95%; max-width: 600px; margin: 0 auto; background: var(--card-bg); border-radius: var(--border-radius); box-shadow: var(--shadow); padding: 24px; animation: fadeIn var(--transition) ease; }
    @keyframes fadeIn { from { opacity:0; transform: translateY(10px);} to { opacity:1; transform: none;} }
    header { text-align:center; margin-bottom:24px; }
    header h1 { font-size:2rem; color:var(--primary-color); margin-bottom:16px; line-height:1.2; }
    header ol { margin:12px auto; padding-left:1.2em; color:#555555; text-align:left; max-width:500px; margin-bottom:16px; }
    header ol li { margin-bottom:6px; }
    header img { width:72%; max-width:576px; margin:16px auto; display:block; border-radius:var(--border-radius); }
    form { display:flex; flex-direction:column; }
    .form-row { margin-bottom:16px; }
    label { font-weight:500; margin-bottom:6px; display:block; font-size:0.95rem; }
    input[type="text"], input[type="email"], input[type="tel"], select, textarea { width:100%; padding:12px; border:1px solid #E2E8F0; border-radius:var(--border-radius); font-size:1rem; transition:border-color var(--transition), box-shadow var(--transition); background-color:#fff; outline:none; }
    input::placeholder, textarea::placeholder { font-style:italic; color:#A0AEC0; }
    input:focus, textarea:focus, select:focus { border-color:var(--primary-color); box-shadow:0 0 4px var(--shadow); }
    select { -webkit-appearance:none; -moz-appearance:none; appearance:none; background-image:url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' width='10' height='10'><path fill='%23666' d='M0,2 L5,8 L10,2 Z'/></svg>"); background-repeat:no-repeat; background-position:right 12px center; background-size:10px; }
    .buttons-container { display:flex; flex-wrap:wrap; justify-content:center; gap:12px; margin-top:24px; }
    .button-proceed, .button-submit-analyze { flex:1 1 auto; min-width:120px; padding:12px 28px; font-size:1rem; font-weight:600; color:#fff; border:none; border-radius:var(--border-radius); cursor:pointer; transition:background-color var(--transition), transform var(--transition); box-shadow:0 4px 10px rgba(0,0,0,0.08); }
    .button-proceed { background-color:var(--secondary-color); }
    .button-submit-analyze { background-color:var(--primary-color); }
    .button-proceed:hover { background-color:#3DCBAA; transform:translateY(-2px); }
    .button-submit-analyze:hover { background-color:#357ABD; transform:translateY(-2px); }
    .required-star { color:red; margin-left:4px; font-size:1.1rem; vertical-align:top; }
    #thanks { display:none; text-align:center; }
    #thanks h2 { color:var(--primary-color); margin-bottom:16px; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>빨간약 EP 앨범 'ROOM 405' 구매 신청서</h1>
      <ol>
        <li>빨간약을 사랑해주시는 여러분 감사합니다!</li>
        <li>입금 계좌는 카카오뱅크 3333-11-9127900 김지영 입니다.</li>
        <li>입금이 완료된 후 신청서가 제출되어야 앨범 구매 신청이 완료됩니다.</li>
        <li>입금자 명과 신청자 명을 동일하게 기입해주시기 바랍니다.</li>
        <li>앨범은 5월 27일 부터 순차적으로 배송됩니다.</li>
        <li>앨범 총 수량은 200장으로, 조기 소진될 수 있습니다.</li>
        <li>문의사항은 빨간약 인스타그램(@redicine_official) DM 혹은 kjihoo7@nate.com로 보내주세요.</li>
      </ol>
      <img src="https://i.ibb.co/0pww6Mqw/Kakao-Talk-Photo-2025-05-19-09-27-34.png" alt="빨간약 EP 앨범 커버">
      <p>아래 정보를 입력하신 후 '다음'을 눌러주세요.</p>
    </header>

    <!-- Page 1 -->
    <form id="page1">
      <div class="form-row"><label for="name">이름<span class="required-star">*</span></label><input type="text" id="name" placeholder="홍길동" required></div>
      <div class="form-row"><label for="email">이메일<span class="required-star">*</span></label><input type="email" id="email" placeholder="example@gmail.com" required></div>
      <div class="form-row"><label for="phone">핸드폰 번호<span class="required-star">*</span></label><input type="tel" id="phone" placeholder="010-1234-5678" required></div>
      <div class="form-row"><label for="address">주소<span class="required-star">*</span></label><input type="text" id="address" placeholder="서울특별시 강남구 ..." required></div>
      <div class="form-row"><label for="quantity">구매 수량 (최대 5)<span class="required-star">*</span></label><select id="quantity" required><option value="" selected>선택</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select></div>
      <div class="form-row"><label for="amount">구매금액 (배송비: 3,000원 / 3장 이상 구매시 배송비 무료)</label><input type="text" id="amount" readonly placeholder="0원"></div>
      <div class="form-row"><label for="coupon">쿠폰 코드 (선택사항)</label><input type="text" id="coupon" placeholder="쿠폰은 빨간약 인스타그램을 통해 확인할 수 있습니다."></div>
      <div class="form-row"><label>입금 여부<span class="required-star">*</span></label><div style="display:flex; gap:12px;"><label><input type="radio" name="depositStatus" value="완료" required> 완료</label><label><input type="radio" name="depositStatus" value="미완료"> 미완료</label></div></div>
      <div class="form-row"><label for="depositName">입금자명<span class="required-star">*</span></label><input type="text" id="depositName" required></div>
      <div class="form-row"><label for="delivery">배송 요청사항</label><input type="text" id="delivery" placeholder="예: 부재 시 경비실에 맡겨주세요"></div>
      <div class="buttons-container"><button type="button" id="next-btn" class="button-proceed">다음</button></div>
    </form>

    <!-- Page 2 -->
    <form id="page2" style="display:none; flex-direction:column;">
      <p style="font-size:0.9rem; color:#555555; text-align:center; margin-bottom:16px;">밑의 질문 사항은 선택 사항으로 답변하지 않으셔도 됩니다.<br>여러분과 소통하고자 하는 빨간약의 작은 노력입니다 (♡)</p>
      <div class="form-row"><label for="route">빨간약을 알게된 경로</label><input type="text" id="route" placeholder="예: SNS, 친구 추천"></div>
      <div class="form-row"><label for="favorite">ROOM 405 앨범 수록곡 중 가장 좋아하는 곡</label><input type="text" id="favorite" placeholder="곡 이름"></div>
      <div class="form-row"><label for="message">빨간약에게 하고 싶은 한마디 (열마디도 가능)</label><textarea id="message" rows="4" placeholder="여기에 적어주세요"></textarea></div>
      <div class="buttons-container"><button type="button" id="back-btn" class="button-proceed">뒤로</button><button type="button" id="submit-btn" class="button-submit-analyze">확인</button></div>
    </form>

    <!-- Thank You -->
    <div id="thanks">
      <h2>감사합니다!</h2>
      <p>신청이 완료되었습니다.</p>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js" defer></script>
    <script defer>
      document.addEventListener('DOMContentLoaded', function() {
        emailjs.init('sngh_2PgQijP7DSmv');
        const headerEl = document.querySelector('header');
        const page1 = document.getElementById('page1');
        const page2 = document.getElementById('page2');
        const thanks = document.getElementById('thanks');
        const qty = document.getElementById('quantity');
        const amount = document.getElementById('amount');
        qty.addEventListener('change', () => {
          const q = parseInt(qty.value) || 0;
          const fmt = n => n.toLocaleString()+'원';
          const ship = q > 0 && q < 3 ? 3000 : 0;
          const total = q*25000 + ship;
          const discount = q*20000 + ship;
          amount.value = q ? `${fmt(total)} (쿠폰 지참시 ${fmt(discount)})` : '';
        });
        document.getElementById('next-btn').addEventListener('click', () => {
          const reqFields = ['name','email','phone','address','quantity','depositName'];
          for (let id of reqFields) {
            if (!document.getElementById(id).value.trim()) {
              alert('필수 항목을 모두 입력해주세요.'); return;
            }
          }
          const status = document.querySelector('input[name="depositStatus"]:checked');
          if (!status) { alert('입금 여부를 선택해주세요.'); return; }
          if (status.value === '미완료') { alert('입금이 완료되어야 구매 가능합니다.'); return; }
          const coupon = document.getElementById('coupon').value.trim();
          if (coupon && coupon.toLowerCase() !== 'redicine') {
            alert('쿠폰코드가 일치하지 않습니다.'); return;
          }
          headerEl.style.display = 'none';
          page1.style.display = 'none';
          page2.style.display = 'flex';
        });
        document.getElementById('back-btn').addEventListener('click', () => {
          headerEl.style.display = 'block';
          page2.style.display = 'none';
          page1.style.display = 'flex';
        });
        document.getElementById('submit-btn').addEventListener('click', () => {
          const params = {
            user_name: document.getElementById('name').value,
            user_email: document.getElementById('email').value,
            user_phone: document.getElementById('phone').value,
            user_address: document.getElementById('address').value,
            user_quantity: document.getElementById('quantity').value,
            user_amount: amount.value,
            user_coupon: document.getElementById('coupon').value.trim(),
            user_depositName: document.getElementById('depositName').value,
            user_delivery: document.getElementById('delivery').value,
            user_route: document.getElementById('route').value,
            user_favorite: document.getElementById('favorite').value,
            user_message: document.getElementById('message').value
          };
          emailjs.send('service_47r2h5k','template_guw6e7h',params)
            .then(() => {
              page2.style.display = 'none';
              thanks.style.display = 'block';
            })
            .catch(e => alert('전송에 실패했습니다: ' + JSON.stringify(e)));
        });
      });
    </script>
  </div>
</body>
</html>
